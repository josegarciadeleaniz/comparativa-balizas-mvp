<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calculadora TCO Balizas IoT</title>
<link rel="icon" href="/images/favicon.ico" type="image/x-icon">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Forum&display=swap" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Forum&display=swap');
    :root {
      --color-primary:   #1e3a8a;
      --color-secondary: #e0f2fe;
      --color-accent:    #f0f9ff;
      --color-gold:      #c49b1b;
      --font-base:       'Forum', serif;
      --radius:          0.5rem;
      --transition:      0.3s ease;
      --shadow-sm:       0 1px 4px rgba(30,58,138,0.1);
      --shadow-md:       0 2px 8px rgba(30,58,138,0.05);
      --shadow-lg:       0 4px 12px rgba(30,58,138,0.15);
      --color-text:      #333;
      --color-border:    #cbd5e1;
    }
    body {
      font-family: var(--font-base);
      background:   var(--color-accent);
      color:        var(--color-text);
      margin:       0 auto;
      padding:      1rem;
      max-width:    900px;
      line-height:  1.5;
    }
    h1, h2, h3 { color: var(--color-primary); margin-bottom: 1rem; }
    h1, h2 { text-align: center; }
    .choices {
      display: flex; justify-content: space-between; gap: 1rem; margin-bottom: 1.5rem;
    }
.calculation-table strong {
  font-family: 'Forum', serif;
  font-weight: 700;       /* usa el bold real */
  color: #000;            /* negro puro */
  -webkit-font-smoothing: antialiased; /* mejora el render en WebKit */
  -moz-osx-font-smoothing: grayscale;  /* mejora en Firefox macOS */
}
		
    .choice {
      flex:1; text-align:center; cursor:pointer;
      border:2px solid transparent; border-radius:var(--radius);
      padding:0.5rem; background:#fff; box-shadow:var(--shadow-sm);
      transition:transform var(--transition), box-shadow var(--transition);
    }
    .choice.selected { border-color:var(--color-primary); transform:translateY(-4px); box-shadow:var(--shadow-lg); }
    .choice img {
      width:160px!important; height:auto!important; aspect-ratio:4/3;
      object-fit:cover; border-radius:var(--radius);
      display:block; margin:0 auto;
    }
    .choice span { display:block; margin-top:0.5rem; font-weight:bold; }
    .forms-container {
      background:#fff; padding:1.5rem; border-radius:var(--radius);
      box-shadow:var(--shadow-md); margin-bottom:1.5rem;
    }
    form { display:none; }
    form.active { display:block; }
    legend, label { font-weight:bold; color:#555; display:block; margin-bottom:0.75rem; }
    select, input[type="number"], input[type="text"], input[type="email"] {
      width:100%; padding:0.5rem; border:1px solid var(--color-border);
      border-radius:var(--radius); margin-top:0.25rem; font-size:1rem;
      transition:border-color var(--transition);
    }
    select:focus, input:focus { border-color:var(--color-primary); outline:none; }
    form img.preview {
      width:200px!important; height:auto!important; max-height:150px!important;
      object-fit:contain!important; display:block; margin:0.5em auto;
      border:none!important; border-radius:var(--radius);
    }
    .btn-calcular, .btn-back { background:var(--color-primary); color:#fff; }
    button { padding:0.75rem 1rem; border:none; border-radius:var(--radius); cursor:pointer;
      font-size:1rem; transition:filter var(--transition), transform var(--transition);
      margin:0.5rem 0.5rem 0 0;
    }
    .btn-limpiar { background:#f1c40f; color:#000; }
    .btn-reiniciar { background:#e74c3c; color:#fff; }
    .btn-pdf { background:#3498db; color:#fff; }
    button:hover { transform:translateY(-2px); filter:brightness(1.1); }
    #results { margin-top:1.5rem; }
    .selected-data-container { border:1px solid var(--color-border); border-radius:var(--radius); overflow:hidden; margin-bottom:1.5rem; }
    .header-stripe { background:var(--color-primary); color:#fff; padding:0.75rem 1rem; font-size:1.25rem; font-weight:bold; }
    .body-data { display:grid; grid-template-columns:1fr auto; gap:1rem; padding:1rem; background:#fff; }
    .meta-list { list-style:none; margin:0; padding:0; }
    .meta-list li { display:flex; justify-content:space-between; padding:0.25rem 0; border-bottom:1px solid var(--color-border); }
    .meta-list li:last-child { border-bottom:none; }
    .result-image { width:200px; text-align:right; }
    .result-image img { width:100%!important; height:auto!important; object-fit:contain; border:none!important; border-radius:var(--radius); }
    .highlights-container { overflow:hidden; margin-bottom:1.5rem; }
    .highlight-row { display:flex; justify-content:space-between; align-items:center;
      padding:0.75rem 1rem; border-bottom:1px solid var(--color-secondary);
    }
    .highlight-row:nth-child(1), .highlight-row:nth-child(2) {
      background:var(--color-secondary); border:1px solid #fff; color:#fff;
    }
    .highlight-row:nth-child(3) {
      background:var(--color-primary); border:1px solid #fff; color:#fff;
    }
    .highlight-row .label, .highlight-row .value { color:#fff; font-weight:bold; font-size:1.1rem; }
    .average-cost { display:flex; justify-content:space-between; padding:0.75rem 1rem; font-size:1.1rem;
      font-weight:bold; border:1px solid var(--color-border); background:#fff; border-radius:var(--radius);
    }
    .average-cost .label { color:var(--color-text); }
    .average-cost .value { color:var(--color-primary); }
    .detailed-section { background:#fff; padding:1rem; border:1px solid var(--color-border);
      border-radius:var(--radius); box-shadow:var(--shadow-sm);
    }
    .toggle-details { color:var(--color-primary); cursor:pointer; user-select:none; margin:0; padding:10px 0; display:inline-block; }
    .details-content { margin-top:1rem; padding-top:1rem; border-top:1px solid var(--color-border); display:none; }
    .calculation-table { width:100%; border-collapse:collapse; margin:1rem 0; font-size:0.95rem; }
    @media (max-width:768px) { .choices{flex-direction:column;} .body-data{grid-template-columns:1fr;} }

.forms-container {
  font-family: var(--font-base);
}

.forms-container input,
.forms-container select {
  font-family: inherit;
  padding: 0.75rem;
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
  margin-top: 0.5rem;
  width: 100%;
  box-sizing: border-box;
}

/* — FORZAR MISMO ESTILO EN TODOS LOS INPUT/SELECT — */
.forms-container label > select,
.forms-container label > input {
  display: block;                    /* Ocupa toda la línea */
  width: 100%;                       /* Ocupa el 100% del contenedor */
  padding: 0.5rem;                   /* Igual que en Form A */
  border: 1px solid var(--color-border);  /* Borde atenuado */
  border-radius: var(--radius);      
  margin-top: 0.25rem;               /* Espacio superior */
  background: #fff;                  /* Fondo blanco */
  box-sizing: border-box;            /* Para que el padding no rompa el ancho */
}

/* Si quieres que los readonly tengan fondo ligeramente gris */
.forms-container input[readonly] {
  background: var(--color-secondary);
}

/* Asegúrate de que tus labels están en bloque */
.forms-container label {
  display: block;
  margin-bottom: 0.75rem;
  color: #555;
  font-weight: bold;
}
/* —— 1) Reubicar la foto de la baliza en Form B y C —— */
#formB, #formC {
  position: relative; /* necesario para posicionar la imagen */
}

/* Coloca la foto justo encima del selector (o tienda) */
#previewBeaconB,
#previewBeaconC {
  position: absolute;
  top: 1.5rem;     /* ajusta para alinear con la línea superior del selector */
  right: 1rem;     /* márgen respecto al borde derecho del form */
  width: 120px;    /* tamaño de la imagen */
  height: auto;
  object-fit: contain;
  border: none !important;
}

/* Mueve un poco hacia arriba el selector para que no choque con la imagen */
#formB select#selectBeacon,
#formC select#selectModeloTienda {
  margin-top: 3rem; /* ajusta según necesites */
}

/* —— 2) Highlights: cambiar texto a negro en las 2 primeras filas —— */
.highlight-row:nth-child(1) .label,
.highlight-row:nth-child(1) .value,
.highlight-row:nth-child(2) .label,
.highlight-row:nth-child(2) .value {
  color: #000;  /* texto negro para que contraste sobre fondo cyan */
}
/* —— Ajustar ancho de selects en Form B y C —— */
#formB label[for="selectBeacon"] select,
#selectBeacon {
  max-width: 600px;     /* ancho máximo que quieras */
  width: 100%;          /* en pantallas pequeñas seguirá siendo responsivo */
}

/* En Form C recortamos tanto el selector de tienda como el de modelo */
#formC label[for="selectTienda"] select,
#selectTienda,
#formC label[for="selectModeloTienda"] select,
#selectModeloTienda {
  max-width: 600px;
  width: 100%;
}

/* Opcional: si quieres que el resto de inputs/selects de B/C mantengan un ancho consistente */
#formB .forms-container select,
#formC .forms-container select {
  max-width: 220px;
}
/* — Subrayado azul oscuro en cada fila de detalle — */
.calculation-table tr {
  border-bottom: 2px solid var(--color-primary);
}

/* — Fondos específicos para ciertas filas — */
/* Reposiciones: fondo beige suave */
.calculation-table tr td:first-child:contains("Reposiciones") {
  background: var(--color-secondary);  /* cyan suave, o cambia por tu beige */
}

/* Coste total estimado por cambio de pilas, coste de fugas y coste de multas: fondo azul fuerte */
.calculation-table tr td:first-child:matches(
    "Coste total estimado por cambio de pilas",
    "Coste de fugas",
    "Coste estimado de multas"
  ) {
  background: var(--color-primary);
  color: #fff;
}
.row-reposiciones { background: var(--color-secondary); }
.row-fondo-azul   {
  background: var(--color-primary);
  color: #fff;
}
/* Amarillo muy claro para “Reposiciones” y para la fila promedio */
.row-reposiciones {
  background-color: #fff9c4 !important; 
}
/* Azul claro para “Coste total estimado por cambio de pilas”, “Coste de fugas” y “Coste de multas” */
.row-fondo-azul {
  background-color: #e0f7fa !important;
}
/* También coloreamos el bloque de gasto medio anual */
.average-cost {
  background-color: #fff9c4;
  padding: 0.75rem;
  border-radius: var(--radius);
  margin-top: 0.5rem;
}
/* Add to existing styles */
.calculation-table {
  font-family: var(--font-base);
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin: 1.5rem 0;
}

.calculation-table th {
  background-color: var(--color-primary);
  color: white;
  padding: 0.75rem;
  text-align: left;
  font-weight: 700;
}

.calculation-table td {
  padding: 0.75rem;
  vertical-align: top;
  border-bottom: 1px solid var(--color-border);
}

.calculation-table tr:nth-child(even) {
  background-color: var(--color-accent);
}

/* Section headers for the 3 main parts */
.section-header {
  background-color: var(--color-primary) !important;
  color: white !important;
  font-weight: 700;
  font-size: 1.1rem;
}

/* Better form styling */
.forms-container label {
  margin-bottom: 1rem;
  display: block;
  font-family: var(--font-base);
}

.forms-container input,
.forms-container select {
  font-family: var(--font-base);
}

/* Better spacing for form sections */
form > label:not(:first-child) {
  margin-top: 1.25rem;
}

/* Consistent button styling */
button {
  font-family: var(--font-base);
  letter-spacing: 0.5px;
}
/* ————————— Detalles de cálculo ————————— */
.row-reposiciones td {
  background-color: #fff9c4;  /* amarillo muy claro */
  /* puedes ajustar el padding si quieres */
}

.row-fondo-azul td {
  background-color: #e3f2fd;  /* azul muy suave */
  color: #000;                /* texto en negro para legibilidad */
}
@media print {
  body {
    font-size: 12pt;
    background: white;
    color: black;
  }
  
  .forms-container, 
  .choices {
    display: none;
  }
  
  .calculation-table {
    page-break-inside: avoid;
  }
}
@media (max-width: 768px) {
  .calculation-table {
    font-size: 0.9rem;
  }
  
  .calculation-table td, 
  .calculation-table th {
    padding: 0.5rem;
  }
}


  </style>
</head>
<body>
  <h1>(TCO) Coste total a 12 años de tu baliza</h1>
  <h2 id="subtitle">Selecciona tu punto de partida</h2>
  
  <div class="choices">
    <div class="choice" data-ctx="A"><img src="/images/pilas.png" alt="Pilas"><span>Ya tengo mi baliza</span></div>
    <div class="choice" data-ctx="B"><img src="/images/modelos.png" alt="Modelos"><span>No sé qué baliza comprar</span></div>
    <div class="choice" data-ctx="C"><img src="/images/tiendas.png" alt="Tiendas"><span>Ver balizas en tienda</span></div>
  </div>

  <div class="forms-container">
    <!-- FORM A -->
    <form id="formA">
      <legend>(A) Ya tengo mi baliza</legend>
      <label>¿Qué pilas lleva tu baliza?
        <select id="selPilaA"></select>
      </label>
      <label>Marca de esas pilas:
        <select id="selMarcaPilaA"></select>
      </label>
      <label>¿Desconectable?
        <select id="desconexion_interna_A"><option value="Sí">Sí</option><option value="No">No</option></select>
      </label>
      <label>¿Incluye funda térmica?
        <select id="funda_termica_A"><option value="No">No</option>
<option value="Tela">Tela</option>
<option value="Neopreno">Neopreno</option>
<option value="EVA Foam">EVA Foam</option></select>
      </label>
      <label>Provincia donde reside tu vehículo:
        <select id="provincia_A"></select>
      </label>
      <label>Precio de compra (€):
        <input id="precio_compra_A" type="number" step="0.01">
      </label>
      <label>Antigüedad de tu coche (años):
        <input id="car_age_A" type="number" min="0" max="30" value="5">
      </label>
      <label>Marca y modelo (opcional):
        <select id="selModeloA"><option value="">— opcional —</option></select>
      </label>
      <button type="submit" class="btn-calcular">Calcular coste</button>
      <button type="button" class="btn-limpiar">Limpiar</button>
      <button type="button" class="btn-reiniciar">Volver al inicio</button>
      <button type="button" class="btn-pdf">Enviar PDF</button>
    </form>

    <!-- FORM B -->
    <form id="formB">
      <legend>(B) Selecciona una baliza</legend>
      <label>Modelo:
        <select id="selectBeacon"></select>
      </label>
      <img id="previewBeaconB" class="preview" alt="Previsualización" style="display:none;">
      <label>Fabricante: <input id="fabricante_B" readonly></label>
      <label>Origen: <input id="origen_B" readonly></label>
      <label>Actuación en España: <input id="actuacion_B" readonly></label>
      <!-- NUEVOS CAMPOS para FORM B -->
      <label>Tipo de pilas: 
        <input id="alimentacion_B" readonly>
      </label>
      <label>Marca de pilas: 
        <input id="marca_pilas_B" readonly>
      </label>
      <label>¿Desconectable?: 
        <input id="desconectable_B" readonly>
      </label>
      <label>¿Incluye funda térmica?: 
        <input id="funda_termica_B" readonly>
      </label>

      <label>Precio: <input id="precio_venta_B" readonly></label>
      <label>Provincia:
        <select id="provincia_B"></select>
      </label>
      <label>Edad del coche:
        <input id="car_age_B" type="number" min="0" max="30" value="5">
      </label>
      <button type="submit" class="btn-calcular">Calcular coste</button>
      <button type="button" class="btn-limpiar">Limpiar</button>
      <button type="button" class="btn-reiniciar">Volver al inicio</button>
      <button type="button" class="btn-pdf">Enviar PDF</button>
    </form>

    <!-- FORM C -->
    <form id="formC">
      <legend>(C) Balizas por tienda</legend>
      <label>Tienda:
        <select id="selectTienda"></select>
      </label>
      <label>Modelo disponible:
        <select id="selectModeloTienda" disabled></select>
      </label>
      <img id="previewBeaconC" class="preview" alt="Previsualización" style="display:none;">
      <label>Fabricante: <input id="fabricante_C" readonly></label>
      <label>Origen: <input id="origen_C" readonly></label>
      <label>Actuación en España: <input id="actuacion_C" readonly></label>
      <!-- NUEVOS CAMPOS para FORM C -->
      <label>Tipo de pilas: 
        <input id="alimentacion_C" readonly>
      </label>
      <label>Marca de pilas: 
        <input id="marca_pilas_C" readonly>
      </label>
      <label>¿Desconectable?: 
        <input id="desconectable_C" readonly>
      </label>
      <label>¿Incluye funda térmica?: 
        <input id="funda_termica_C" readonly>
      </label>

      <label>Precio: <input id="precio_venta_C" readonly></label>
      <label>Provincia:
        <select id="provincia_C"></select>
      </label>
      <label>Edad del coche:
        <input id="car_age_C" type="number" min="0" max="30" value="5">
      </label>
      <button type="submit" class="btn-calcular">Calcular coste</button>
      <button type="button" class="btn-limpiar">Limpiar</button>
      <button type="button" class="btn-reiniciar">Volver al inicio</button>
      <button type="button" class="btn-pdf">Enviar PDF</button>
    </form>
  </div>

  <div id="results" style="display:none;"></div>

  <div id="pdfModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000;">
    <div style="background:white; width:80%; max-width:400px; margin:100px auto; padding:20px; border-radius:var(--radius);">
      <h3>Enviar resultados por email</h3>
      <input type="email" id="pdfEmail" placeholder="Tu email" style="width:100%; padding:8px; margin:10px 0;">
      <button onclick="enviarPDF()" style="background:var(--color-primary); color:white; border:none; padding:8px 16px; border-radius:4px;">Enviar</button>
      <button onclick="document.getElementById('pdfModal').style.display='none'" style="margin-left:10px; background:#ccc; border:none; padding:8px 16px; border-radius:4px;">Cancelar</button>
    </div>
  </div>

  <pre id="debugResultado"></pre>
   <script src="script.js" defer></script>
</body>
</html>
